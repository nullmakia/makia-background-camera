html, body, #pano { height: 100%; margin: 0; background: #000; }
#pano { position: fixed; inset: 0; z-index: 0; }

/* ★カメラ背景 */
.bgcam {
  position: fixed;
  inset: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;   /* 画面いっぱいにトリミング */
  z-index: 0;
  background: #000;    /* カメラ未許可時の背景 */
}

/* —— キャラ（前景） —— */
.sprite {
  position: fixed; z-index: 2000; pointer-events: auto; touch-action: manipulation;
  filter: drop-shadow(0 8px 14px rgba(0,0,0,.35)); user-select: none;
}
.boy {
  left: 12vw; bottom: 10vh; width: min(40vw, 320px); aspect-ratio: 5/6;
  background: url('fool1.png') center / contain no-repeat;
}
.dog {
  left: calc(6vw + min(20vw, 100px) + 15vw); bottom: 11vh; width: min(15vw, 200px); aspect-ratio: 5/6;
  background: url('fool2.png') center / contain no-repeat;
}

/* アニメーション */
@keyframes boyJump {
  0% { transform: translateY(0) rotate(0) }
  20%{ transform: translateY(-14px) rotate(-2deg) }
  40%{ transform: translateY(-22px) rotate(2deg) }
  60%{ transform: translateY(-10px) rotate(-1deg) }
  100%{ transform: translateY(0) rotate(0) }
}
.boy.react { animation: boyJump .7s ease-out; }

@keyframes dogShake {
  0% { transform: translateY(0) rotate(0) }
  15%{ transform: translateY(-6px) rotate(-6deg) }
  30%{ transform: translateY(-6px) rotate(6deg) }
  45%{ transform: translateY(-6px) rotate(-6deg) }
  60%{ transform: translateY(-2px) rotate(4deg) }
  100%{ transform: translateY(0) rotate(0) }
}
.dog.react { animation: dogShake .6s ease-out; }

/* 吹き出し */
.bubble {
  position: absolute; left: 50%; bottom: 100%; transform: translateX(-50%);
  white-space: nowrap; background: rgba(255,255,255,.95); color: #222;
  font: 600 14px/1.2 system-ui,-apple-system,"Segoe UI",sans-serif;
  padding: 8px 10px; border-radius: 14px; border: 1px solid rgba(0,0,0,.15);
  box-shadow: 0 6px 12px rgba(0,0,0,.18); opacity: 0; animation: pop .75s ease forwards; z-index: 20;
}
@keyframes pop {
  0%{ transform: translate(-50%,6px) scale(.9); opacity: 0 }
  40%{ transform: translate(-50%,0) scale(1); opacity: 1 }
  90%{ opacity: 1 } 100%{ opacity: 0 }
}

/* Street View も背景層。どちらを前面にするかは display で切替 */
#pano { z-index: 0; }
/* 汎用：非表示切替用 */
.hidden { display: none !important; }

/* HUD / テロップ / マイクボタン */
.hud { position: fixed; top: 12px; left: 12px; z-index: 3000; color: #fff; text-shadow:0 1px 3px rgba(0,0,0,.6) }
#aiTelopBox {
  position: fixed; left: 12px; right: 12px; bottom: 12px; padding: 10px 12px; background: rgba(255,255,255,.92);
  border: 1px solid #e5e5e5; border-radius: 12px; backdrop-filter: blur(4px); box-shadow: 0 4px 18px rgba(0,0,0,.12);
  z-index: 4000; font-size: 14px;
}
#micBtn {
  position: fixed; right: 12px; bottom: 80px; z-index: 4001; padding: 10px 12px; border: 1px solid #111;
  background: #111; color: #fff; border-radius: 10px;
}
#stopBtn {
  position: fixed; right: 12px; bottom: 38px; z-index: 4001; padding: 10px 12px; border: 1px solid #111;
  background: #444; color: #fff; border-radius: 10px;
}
.meter {
  position: fixed; left: 12px; right: 120px; bottom: 54px; height: 8px; background: rgba(255,255,255,.5);
  border-radius: 999px; overflow: hidden; z-index: 4001;
}
.bar { height: 100%; width: 0% }
